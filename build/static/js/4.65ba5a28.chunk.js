(this["webpackJsonpchat-app-frontend"]=this["webpackJsonpchat-app-frontend"]||[]).push([[4],{131:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return N}));var s=a(128),c=a(72),n=a.n(c),r=a(74),i=a(71),o=a(0),l=(a(75),a(12)),j=a(6);function u(){return Object(j.jsxs)("div",{className:"topbarContainer",children:[Object(j.jsx)("div",{className:"topbarLeft",children:Object(j.jsx)(l.b,{to:"/",style:{textDecoration:"none"},children:Object(j.jsx)("span",{className:"logo",children:"Chat Now"})})}),Object(j.jsx)("div",{className:"topbarCenter"}),Object(j.jsxs)("div",{className:"topbarRight",children:[Object(j.jsxs)("div",{className:"topbarLinks",children:[Object(j.jsx)("span",{className:"topbarLink"}),Object(j.jsx)("span",{className:"topbarLink"})]}),Object(j.jsxs)("div",{className:"topbarIcons",children:[Object(j.jsx)("div",{className:"topbarIconItem",children:Object(j.jsx)("span",{className:""})}),Object(j.jsx)("div",{className:"topbarIconItem",children:Object(j.jsx)("span",{className:""})}),Object(j.jsx)("div",{className:"topbarIconItem",children:Object(j.jsx)("span",{className:""})})]}),Object(j.jsx)(l.b,{to:"/profile/rahulmore",children:Object(j.jsx)("img",{src:"https://lh3.googleusercontent.com/ogw/ADea4I708VJFYx3XKTF8u0dK-w-WsiENrtFo3h5q5flbpbM=s32-c-mo",alt:"Rahul More",className:"topbarImg"})})]})]})}a(76),a(77);function d(e){e.conversations;var t=Object(o.useState)(null),a=Object(i.a)(t,2);a[0],a[1];return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"conversation",children:[Object(j.jsx)("img",{src:"https://avatars.githubusercontent.com/u/25549118?v=4",alt:"Rahul More",className:"conversationImage"}),Object(j.jsx)("span",{className:"conversationName",children:"Rahul More"})]})})}a(78);function b(e){var t=e.message,a=e.own;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:a?"messages own":"messages",children:[Object(j.jsxs)("div",{className:"messageTop",children:[Object(j.jsx)("img",{className:"messageImage",src:"https://avatars.githubusercontent.com/u/25549118?v=4",alt:"Message Images"}),Object(j.jsx)("p",{className:"messageText",children:t.text})]}),Object(j.jsx)("div",{className:"messageBottom",children:new Date(t.createdAt).toDateString()})]})})}a(79);function h(){return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("div",{className:"chatOnline",children:Object(j.jsxs)("div",{className:"chatOnlineFriend",children:[Object(j.jsx)("div",{className:"chatOnlineImageContainer",children:Object(j.jsxs)("div",{className:"chatOnlineImageContainer",children:[Object(j.jsx)("img",{src:"https://avatars.githubusercontent.com/u/25549118?v=4",alt:"Rahul More",className:"chatOnlineImage"}),Object(j.jsx)("div",{className:"chatOnlineBadge"})]})}),Object(j.jsx)("span",{className:"chatOnlineName",children:"Rahul More"})]})})})}var m="localhost:3000"===window.location.host?"http://localhost:5256":"",O="/api/conversations",x="/api/messages",p=function(){return JSON.parse(localStorage.getItem("chat-app-token"))},v=a(80),f=a.n(v),g=a(98);function N(){var e=Object(o.useState)(!1),t=Object(i.a)(e,2),a=(t[0],t[1]),c=Object(o.useState)([]),l=Object(i.a)(c,2),v=l[0],N=l[1],I=Object(o.useState)(null),w=Object(i.a)(I,2),k=w[0],S=w[1],M=Object(o.useState)(null),C=Object(i.a)(M,2),F=C[0],B=C[1],R=Object(o.useState)(""),E=Object(i.a)(R,2),_=E[0],y=E[1],T=Object(o.useState)(null),D=Object(i.a)(T,2),W=D[0],A=D[1],J=Object(o.useState)([]),L=Object(i.a)(J,2),V=L[0],K=L[1],U=Object(o.useRef)(),q=Object(o.useRef)(),P=function(){var e=Object(r.a)(n.a.mark((function e(){var t,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.prev=1,t=m+O+"/"+p().data._id,e.next=5,f.a.get(t);case 5:s=e.sent,N(s.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("err ===> "+e.t0);case 12:a(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(r.a)(n.a.mark((function e(){var t,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.prev=1,t=m+x+"/"+(null===k||void 0===k?void 0:k._id),e.next=5,f.a.get(t);case 5:!0===(s=e.sent).data.error?console.log(s.data.title):B(s.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:a(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(r.a)(n.a.mark((function e(t){var a,c,r,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(null!==_&&""!==_||(K({message:"Please enter a message"}),0))){e.next=18;break}return K({}),a={sender:p().data._id,text:_,conversationId:k._id},c=k.members.find((function(e){return e!==p().data._id})),q.current.emit("sendMessage",{senderId:p().data._id,recevierId:c,text:_}),e.prev=6,r=m+x,e.next=10,f.a.post(r,a);case 10:i=e.sent,B([].concat(Object(s.a)(F),[i.data.data])),y(""),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(6),console.log("There is an error!");case 18:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){var e,t;null===(e=q.current)||void 0===e||e.emit("addUser",p().data),null===(t=q.current)||void 0===t||t.on("getUsers",(function(e){console.log("users ===> ",e)}))}),[p().data]),Object(o.useEffect)((function(){var e;null===(e=U.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[F]),Object(o.useEffect)((function(){X()}),[k]),Object(o.useEffect)((function(){q.current=Object(g.io)("ws://localhost:8900"),q.current.on("getMessage",(function(e){A({sender:e.senderId,text:e.text,createdAt:e.createdAt})}))}),[]),Object(o.useEffect)((function(){W&&(null===k||void 0===k?void 0:k.members.includes(W.sender))&&B((function(e){return[].concat(Object(s.a)(e),[W])}))}),[W,k]),Object(o.useEffect)((function(){P()}),[]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(u,{}),Object(j.jsxs)("div",{className:"messanger",children:[Object(j.jsx)("div",{className:"chatMenu",children:Object(j.jsxs)("div",{className:"chatMenuWrapper",children:[Object(j.jsx)("input",{placeholder:"Search for freinds...",className:"chatMenuInput"}),v.map((function(e){return Object(j.jsx)("div",{onClick:function(){return S(e)},children:Object(j.jsx)(d,{conversations:e})})}))]})}),Object(j.jsx)("div",{className:"chatBox",children:Object(j.jsx)("div",{className:"chatBoxWrapper",children:k?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"chatBoxTop",children:F.length>0?F.map((function(e){return Object(j.jsx)("div",{ref:U,children:Object(j.jsx)(b,{message:e,own:e.sender===p().data._id})})})):Object(j.jsx)("span",{className:"initConversation",children:"Start Chatting!"})}),Object(j.jsxs)("div",{className:"chatBoxBottom",children:[Object(j.jsx)("input",{type:"text",name:"chat",placeholder:"Write what's on your mind?",className:"chatMessageInput",defaultValue:_,onChange:function(e){return y(e.target.value)}}),Object(j.jsx)("button",{className:"chatSubmitButton",onClick:Y,children:"Send"})]}),Object(j.jsx)("span",{className:"text-danger",children:V.message})]}):Object(j.jsx)("span",{className:"noConversationText",children:"Choose conversation to start messaging!"})})}),Object(j.jsx)("div",{className:"chatOnline",children:Object(j.jsxs)("div",{className:"chatOnlineWrapper",children:[Object(j.jsx)(h,{}),Object(j.jsx)(h,{}),Object(j.jsx)(h,{}),Object(j.jsx)(h,{}),Object(j.jsx)(h,{})]})})]})]})}},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){},79:function(e,t,a){}}]);
//# sourceMappingURL=4.65ba5a28.chunk.js.map